{
  "$id": "https://schemas.meshery.io/evaluationResponse.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Schema for the response of a relationship evaluation process in Meshery",
  "additionalProperties": false,
  "type": "object",

  "required": ["schemaVersion", "design"],

  "properties": {
    "schemaVersion": {
      "$ref": "../core.json#/definitions/versionString",
      "description": "Specifies the version of the schema to which the evaluation response conforms."
    },

    "design": {
      "$ref": "../v1beta1/design.json",
      "description": "The final evaluated design, including all updated components and relationships. Can be the whole updated design or only the diff of changes. version of the design will be bumped if there are any changes done"
    },

    "trace": {
      "type": "object",
      "description": "A detailed trace of the evaluation process, including actions taken and changes made.",
      "properties": {
        "policyActions": {
          "type": "array",
          "description": "List of policy actions applied during the evaluation.",
          "items": {
            "type": "string"
          }
        },
        "relationshipsAdded": {
          "type": "array",
          "description": "List of new relationships added to the design.",
          "items": {
            "$ref": "../v1beta1/relationship.json"
          }
        },
        "relationshipsRemoved": {
          "type": "array",
          "description": "List of relationships removed from the design.",
          "items": {
            "$ref": "../v1beta1/relationship.json"
          }
        },
        "componentsAdded": {
          "type": "array",
          "description": "List of new components added to the design.",
          "items": {
            "$ref": "../v1beta1/component.json"
          }
        },
        "componentsRemoved": {
          "type": "array",
          "description": "List of components removed from the design.",
          "items": {
            "$ref": "../v1beta1/component.json"
          }
        }
      },
      "required": [
        "policyActions",
        "relationshipsAdded",
        "relationshipsRemoved",
        "componentsAdded",
        "componentsRemoved"
      ]
    },
    "evaluationHash": {
      "type": "string",
      "description": "Hash of the evaluation response, used for tracking and comparison."
    },

    "metadata": {
      "type": "object",
      "description": "Additional metadata about the evaluation process.",
      "properties": {
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 formatted timestamp of when the evaluation was completed."
        }
      },
      "required": ["timestamp"]
    }
  }
}

